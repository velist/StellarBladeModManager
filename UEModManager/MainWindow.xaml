<Window x:Class="UEModManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        Title="爱酱MOD管理器" 
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#0B1426">
    
    <Window.Resources>
        <!-- 分类项样式 - 修复为预期样式 -->
        <Style x:Key="CategoryItemStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border Name="Border" Background="Transparent" CornerRadius="8" Padding="12,10" Margin="0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- 分类名称 -->
                                <TextBlock Name="CategoryName" Grid.Column="0" Text="{Binding Name}" Foreground="#F1F5F9" 
                                           FontSize="14" FontWeight="Normal" VerticalAlignment="Center"/>
                                
                                <!-- 数字徽章 -->
                                <Border Grid.Column="1" Background="#FBBF24" CornerRadius="8" Padding="8,4" MinWidth="24" Height="20">
                                    <TextBlock Text="{Binding Count}" Foreground="#1E2A3A" 
                                               FontSize="10" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#1A2433"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#FBBF24"/>
                                <Setter TargetName="CategoryName" Property="Foreground" Value="#1E2A3A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 圆角渐变按钮样式 -->
        <Style x:Key="GradientCornerButton" TargetType="Button">
            <Setter Property="Foreground" Value="#1E2A3A"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="20" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                                    <GradientStop Color="#00D4AA" Offset="0"/>
                                    <GradientStop Color="#FBBF24" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 次要操作药丸按钮样式 -->
        <Style x:Key="SecondaryPillButton" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="20" Background="#414A5C" BorderBrush="#6B7280" BorderThickness="1" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#525A6C"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#9CA3AF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#313A4C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="40"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
        </Grid.ColumnDefinitions>
        
        <!-- A区：顶部导航栏 -->
        <Border Grid.ColumnSpan="3" Grid.Row="0" Background="#0F1B2E" BorderBrush="#1A2332" BorderThickness="0,0,0,1">
            <Grid Margin="20,10">
                
                <!-- 左侧：品牌和游戏选择器 -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Left">
                    <!-- Logo和标题 - 渐变色无背景 -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock FontSize="18" Text="📦" Margin="0,0,8,0" VerticalAlignment="Center"/>
                        <TextBlock Text="虚幻引擎MOD管理器" FontSize="16" FontWeight="Bold" VerticalAlignment="Center">
                            <TextBlock.Foreground>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="#00D4AA" Offset="0"/>
                                    <GradientStop Color="#0EA5E9" Offset="1"/>
                                </LinearGradientBrush>
                            </TextBlock.Foreground>
                        </TextBlock>
                    </StackPanel>
                    
                    <!-- 游戏选择器 - 彻底修复样式和字体问题 -->
                    <ComboBox x:Name="GameList" 
                              Background="Transparent" 
                              Foreground="#F1F5F9"
                              BorderBrush="#6B7280" 
                              BorderThickness="1"
                              FontSize="14" 
                              MinWidth="160" 
                              Padding="12,10"
                              VerticalContentAlignment="Center"
                              SelectionChanged="GameList_SelectionChanged"
                              Margin="25,0,0,0">
                        <ComboBoxItem Content="请选择游戏"/>
                        <ComboBoxItem Content="剑星 (Stellar Blade)"/>
                        <ComboBoxItem Content="黑神话·悟空"/>
                        <ComboBoxItem Content="光与影：33号远征队"/>
                        <ComboBoxItem Content="其他虚幻引擎游戏"/>
                        <ComboBox.Style>
                            <!-- 临时简化样式，用于诊断StaticResourceHolder错误 -->
                            <Style TargetType="ComboBox">
                                <Setter Property="Background" Value="#334155"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="BorderBrush" Value="#6B7280"/>
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="Padding" Value="10,8"/>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Background" Value="#334155"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="Padding" Value="12,10"/>
                                <Style.Triggers>
                                    <Trigger Property="IsHighlighted" Value="True">
                                        <Setter Property="Background" Value="#FBBF24"/>
                                        <Setter Property="Foreground" Value="#1E2A3A"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>
                </StackPanel>
                
                <!-- 右侧：搜索框和功能按钮 -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <!-- 搜索框 - 修改提示文字并添加点击清除功能 -->
                    <Border BorderBrush="#6B7280" BorderThickness="1" CornerRadius="8" Margin="0,0,15,0" Padding="4,2" MinWidth="320">
                        <Grid>
                            <StackPanel Orientation="Horizontal" Margin="12,6">
                                <TextBlock Text="🔍" Margin="0,0,8,0" Foreground="#FBBF24" FontSize="14" VerticalAlignment="Center"/>
                                <TextBox x:Name="SearchBox" Text="" 
                                         Foreground="#F1F5F9" Background="Transparent" BorderThickness="0" 
                                         FontSize="12" VerticalAlignment="Center" Width="260"
                                         GotFocus="SearchBox_GotFocus" LostFocus="SearchBox_LostFocus"/>
                                <TextBlock x:Name="SearchPlaceholder" Text="输入MOD名称或描述关键词..." 
                                           Foreground="#9CA3AF" FontSize="12" VerticalAlignment="Center" 
                                           IsHitTestVisible="False" Margin="-260,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- 功能按钮组 -->
                    <StackPanel Orientation="Horizontal">
                        <Button Background="Transparent" BorderThickness="0" Padding="8,6" Content="🔄" 
                                Click="RefreshButton_Click" ToolTip="刷新数据" Foreground="#6B7280"/>
                        <Button Background="Transparent" BorderThickness="0" Padding="8,6" Content="🔔" 
                                Click="NotificationButton_Click" ToolTip="通知设置" Foreground="#6B7280"/>
                        <Button Background="Transparent" BorderThickness="0" Padding="8,6" Content="⚙️" 
                                Click="SettingsButton_Click" ToolTip="设置" Foreground="#6B7280"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- B区：左侧面板 -->
        <Border Grid.Row="1" Grid.Column="0" Background="#0F1B2E" BorderBrush="#1A2332" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- B1区：MOD分类 - 固定标题 -->
                <Border Grid.Row="0" Background="#0F1B2E" Padding="20,15,20,10">
                    <StackPanel>
                        <!-- 标题行 -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="📁" Foreground="#00D4AA" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="MOD分类" Foreground="#00D4AA" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- 状态过滤按钮组 - 改进布局对齐 -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="EnabledFilterBtn" Grid.Column="0" Content="已启用" Background="#10B981" Foreground="White" 
                                    BorderThickness="0" Padding="12,8" FontSize="12" Margin="0,0,4,0"
                                    Click="EnabledFilterBtn_Click" ToolTip="显示已启用的MOD">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Opacity" Value="0.8"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button x:Name="DisabledFilterBtn" Grid.Column="1" Content="已禁用" Background="#DC2626" Foreground="White" 
                                    BorderThickness="0" Padding="12,8" FontSize="12" Margin="4,0,0,0"
                                    Click="DisabledFilterBtn_Click" ToolTip="显示已禁用的MOD">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Opacity" Value="0.8"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                        
                        <!-- 操作按钮行 -->
                        <StackPanel Orientation="Horizontal">
                            <Button Content="新增" Background="Transparent" Foreground="White" 
                                    BorderBrush="White" BorderThickness="1" Padding="12,6" FontSize="12" Margin="0,0,8,0"
                                    Click="AddCategoryButton_Click" ToolTip="添加新分类"/>
                            <Button Content="删除" Background="Transparent" Foreground="White" 
                                    BorderBrush="White" BorderThickness="1" Padding="12,6" FontSize="12" Margin="0,0,8,0"
                                    Click="DeleteCategoryButton_Click" ToolTip="删除分类"/>
                            <Button Content="重命名" Background="Transparent" Foreground="White" 
                                    BorderBrush="White" BorderThickness="1" Padding="12,6" FontSize="12"
                                    Click="RenameCategoryButton_Click" ToolTip="重命名分类"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- 分类列表容器 -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <StackPanel Margin="15,0,15,20">
                        <!-- 分类列表 -->
                        <ListBox x:Name="CategoryList" Background="Transparent" BorderThickness="0" 
                                 ItemContainerStyle="{StaticResource CategoryItemStyle}">
                            <ListBox.ContextMenu>
                                <ContextMenu Background="#2A3441" Foreground="White">
                                    <MenuItem Header="新增子分类" Click="AddSubCategoryMenuItem_Click"/>
                                    <Separator/>
                                    <MenuItem Header="重命名" Click="RenameCategoryMenuItem_Click"/>
                                    <MenuItem Header="删除" Click="DeleteCategoryMenuItem_Click"/>
                                </ContextMenu>
                            </ListBox.ContextMenu>
                        </ListBox>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>
        
        <!-- 主内容区 -->
        <ScrollViewer Grid.Row="1" Grid.Column="1" VerticalScrollBarVisibility="Auto" Background="#0B1426">
            <StackPanel Margin="20">
                <Grid Margin="0,0,0,20">
                    <!-- 动态显示当前MOD数量 -->
                    <TextBlock x:Name="ModCountText" Text="全部 MOD (0)" FontSize="18" FontWeight="Bold" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Border BorderBrush="#2A3441" BorderThickness="1" CornerRadius="8" Padding="8,5" Margin="0,0,10,0">
                            <CheckBox Content="全选" Foreground="White" VerticalAlignment="Center"/>
                        </Border>
                        <Button x:Name="ImportModBtn" Content="📥 导入MOD" Style="{StaticResource GradientCornerButton}"/>
                    </StackPanel>
                </Grid>
                <ItemsControl x:Name="ModsGrid">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" Margin="-10"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border x:Name="CardBorder" Width="240" Height="270" Margin="10" Background="#1A2433" 
                                    CornerRadius="8" BorderBrush="#2A3441" BorderThickness="1" 
                                    MouseDown="ModCard_MouseDown" Cursor="Hand">
                                <!-- 添加右键菜单 -->
                                <Border.ContextMenu>
                                    <ContextMenu Background="#2A3441" Foreground="White">
                                        <MenuItem x:Name="EnableModMenuItem" Header="启用MOD" Click="EnableModMenuItem_Click"/>
                                        <MenuItem x:Name="DisableModMenuItem" Header="禁用MOD" Click="DisableModMenuItem_Click"/>
                                        <Separator/>
                                        <MenuItem Header="重命名" Click="RenameModMenuItem_Click"/>
                                        <MenuItem Header="修改预览图" Click="ChangePreviewMenuItem_Click"/>
                                        <Separator/>
                                        <MenuItem Header="删除MOD" Click="DeleteModMenuItem_Click"/>
                                    </ContextMenu>
                                </Border.ContextMenu>
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Effect" Value="{x:Null}"/>
                                        <Setter Property="RenderTransform">
                                            <Setter.Value>
                                                <TranslateTransform Y="0"/>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="BorderBrush" Value="#FBBF24"/>
                                                <Setter Property="Effect">
                                                    <Setter.Value>
                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="15" Color="#FBBF24" Opacity="0.5"/>
                                                    </Setter.Value>
                                                </Setter>
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <TranslateTransform Y="-5"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- 预览图区域 -->
                                    <Border Grid.Row="0" Margin="4" CornerRadius="8" Background="#0F1B2E" ClipToBounds="True">
                                        <Grid>
                                            <!-- 预览图片 - 直接绑定到预加载的ImageSource -->
                                            <Image x:Name="PreviewImage"
                                                   Source="{Binding PreviewImageSource}" 
                                                   Stretch="UniformToFill" 
                                                   VerticalAlignment="Center" 
                                                   HorizontalAlignment="Center"
                                                   Visibility="{Binding PreviewImageSource, Converter={StaticResource NullToVisibilityConverter}}"/>
                                            
                                            <!-- 图标占位符 - 在没有ImageSource时显示 -->
                                            <Viewbox Visibility="{Binding PreviewImageSource, Converter={StaticResource InverseNullToVisibilityConverter}}">
                                                <TextBlock Text="📦" FontSize="60" Foreground="#334155" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Viewbox>
                                        </Grid>
                                    </Border>
                                    
                                    <!-- 状态徽章 -->
                                    <Border CornerRadius="8" Padding="10,5" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="12">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="#6B7280"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Status}" Value="已启用">
                                                        <Setter Property="Background" Value="#10B981"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock Text="{Binding Status}" FontSize="11" FontWeight="Bold" Foreground="White"/>
                                    </Border>
                                    
                                    <!-- 内容区域 -->
                                    <StackPanel Grid.Row="1" Margin="15,12">
                                        <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="White" FontSize="15" Margin="0,0,0,5"/>
                                        <TextBlock Text="{Binding Description}" FontSize="12" Foreground="#9CA3AF" 
                                                   TextWrapping="Wrap" Height="34" Margin="0,0,0,10"/>
                                        <Grid>
                                            <!-- 类型标签 - 改为可点击切换 -->
                                            <Border Background="#40FBBF24" CornerRadius="8" Padding="6,3" HorizontalAlignment="Left" VerticalAlignment="Center" 
                                                    Cursor="Hand" MouseDown="TypeTag_MouseDown" Tag="{Binding}">
                                                <TextBlock Text="{Binding Type}" FontSize="11" Foreground="#FBBF24" FontWeight="Medium"/>
                                            </Border>
                                            
                                            <!-- 操作按钮 -->
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                <Button Content="👁" Background="Transparent" BorderThickness="0" Foreground="#9CA3AF" 
                                                        Padding="4" FontSize="14" ToolTip="切换状态" Tag="{Binding}" Click="ToggleModStatus"/>
                                                <Button Content="⚙" Background="Transparent" BorderThickness="0" Foreground="#9CA3AF" 
                                                        Padding="4" FontSize="14" ToolTip="编辑MOD" Tag="{Binding}" Click="EditModButton_Click"/>
                                                <Button Content="🗑" Background="Transparent" BorderThickness="0" Foreground="#9CA3AF" 
                                                        Padding="4" FontSize="14" ToolTip="删除MOD" Tag="{Binding}" Click="DeleteModButton_Click"/>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
        
        <!-- 右侧面板 -->
        <Border Grid.Row="1" Grid.Column="2" Background="#0F1B2E" BorderBrush="#1A2332" BorderThickness="1,0,0,0">
            <ScrollViewer>
                <StackPanel Margin="20">
                    <Border Margin="0,0,0,20" BorderBrush="#1A2332" BorderThickness="0,0,0,1" Padding="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" x:Name="ModNameText" Text="伊芙战斗服" FontSize="20" FontWeight="600" 
                                      Foreground="#F1F5F9" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                            
                            <!-- 自定义滑块开关 -->
                            <Border Grid.Column="1" x:Name="CustomToggle" Background="#4A5568" CornerRadius="12" 
                                   Height="24" Width="44" VerticalAlignment="Center" Cursor="Hand" 
                                   MouseDown="CustomToggle_MouseDown">
                                <Border x:Name="ToggleThumb" Background="White" CornerRadius="10" 
                                       Height="20" Width="20" HorizontalAlignment="Left" Margin="2,0,0,0"/>
                            </Border>
                        </Grid>
                    </Border>
                    <Border Height="200" CornerRadius="12" Background="#0B1426" Margin="0,0,0,20" BorderBrush="#1A2332" BorderThickness="1" ClipToBounds="True">
                        <Grid>
                            <!-- 预览图片 -->
                            <Image x:Name="ModDetailPreviewImage" 
                                   Stretch="UniformToFill" 
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                            
                            <!-- 图标占位符 - 只在没有预览图时显示 -->
                            <Viewbox x:Name="ModDetailIconContainer" Visibility="Collapsed">
                                <TextBlock x:Name="ModDetailIcon" Text="👕" FontSize="60" Foreground="#334155"/>
                            </Viewbox>
                        </Grid>
                    </Border>
                    <Border Background="#0B1426" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="状态:" Width="100" Foreground="#94A3B8"/>
                                <TextBlock x:Name="ModStatusText" Text="未选择" Foreground="#6B7280" FontWeight="500"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="原始名称:" Width="100" Foreground="#94A3B8"/>
                                <TextBlock x:Name="ModOriginalNameText" Text="-" Foreground="#F1F5F9"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="导入日期:" Width="100" Foreground="#94A3B8"/>
                                <TextBlock x:Name="ModImportDateText" Text="-" Foreground="#F1F5F9"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="文件大小:" Width="100" Foreground="#94A3B8"/>
                                <TextBlock x:Name="ModSizeText" Text="-" Foreground="#FFD700" FontWeight="500"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="描述:" Width="100" Foreground="#94A3B8" VerticalAlignment="Top"/>
                                <TextBlock x:Name="ModDescriptionText" Text="请选择一个MOD查看详情" 
                                           Foreground="#F1F5F9" TextWrapping="Wrap" Width="180"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    <!-- 操作按钮 - 恢复为2x2栅格布局，并修复文字折叠问题 -->
                    <UniformGrid Columns="2" Rows="2" Margin="0,0,0,20">
                        <Button MinHeight="48" BorderBrush="#2A3441" BorderThickness="1" Padding="8,4" Margin="4"
                                Click="RenameModButton_Click" ToolTip="修改MOD名称">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#1A2433" BorderBrush="{TemplateBinding BorderBrush}" 
                                            BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8" 
                                            Padding="{TemplateBinding Padding}">
                                        <TextBlock Text="✏️ 重命名" Foreground="#F1F5F9" FontSize="13"
                                                   TextWrapping="Wrap" TextAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        <Button MinHeight="48" BorderBrush="#2A3441" BorderThickness="1" Padding="8,4" Margin="4"
                                Click="ChangePreviewButton_Click" ToolTip="修改MOD预览图">
                             <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#1A2433" BorderBrush="{TemplateBinding BorderBrush}" 
                                            BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8" 
                                            Padding="{TemplateBinding Padding}">
                                        <TextBlock Text="🖼️ 修改预览图" Foreground="#F1F5F9" FontSize="13"
                                                   TextWrapping="Wrap" TextAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        <Button MinHeight="48" BorderBrush="#2A3441" BorderThickness="1" Padding="8,4" Margin="4"
                                Click="DisableModButton_Click" ToolTip="禁用当前MOD">
                             <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#1A2433" BorderBrush="{TemplateBinding BorderBrush}" 
                                            BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8" 
                                            Padding="{TemplateBinding Padding}">
                                        <TextBlock Text="⛔ 禁用MOD" Foreground="#F1F5F9" FontSize="13"
                                                   TextWrapping="Wrap" TextAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        <Button MinHeight="48" BorderBrush="#2A3441" BorderThickness="1" Padding="8,4" Margin="4"
                                Click="DeleteCurrentModButton_Click" ToolTip="删除当前MOD">
                             <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="#1A2433" BorderBrush="{TemplateBinding BorderBrush}" 
                                            BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="8" 
                                            Padding="{TemplateBinding Padding}">
                                        <TextBlock Text="🗑️ 删除MOD" Foreground="#F1F5F9" FontSize="13"
                                                   TextWrapping="Wrap" TextAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </UniformGrid>
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- 底部状态栏 -->
        <Border Grid.Row="2" Grid.ColumnSpan="3" Background="#0F1B2E" BorderBrush="#1A2332" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="MOD目录: D:\steam\steamapps\common\StellarBlade\SB\Content\Paks\~mods" 
                           Foreground="#94A3B8" FontSize="12" Margin="20,0" Width="400"/>
                <TextBlock x:Name="SystemInfoText" Text="已加载MOD: 54/54 | 内存占用: 54.0GB" 
                           Foreground="#94A3B8" FontSize="12" Margin="20,0"/>
                <TextBlock Text="虚幻引擎MOD管理器 v1.9.0 (20250105) | 支持黑神话·悟空、剑星等UE游戏" 
                           Foreground="#94A3B8" FontSize="12" HorizontalAlignment="Right" Margin="20,0"/>
            </StackPanel>
        </Border>
        
        <!-- 操作工具栏 (悬浮Bar) -->
        <Border Grid.Row="1" Grid.Column="1" VerticalAlignment="Bottom" HorizontalAlignment="Center" 
                Background="#1A2433" CornerRadius="8" Padding="10" Margin="0,0,0,25"
                BorderBrush="#2A3441" BorderThickness="1">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="ImportModBtn2" Content="📥 导入MOD" Style="{StaticResource GradientCornerButton}" Margin="0,0,10,0"/>
                <Button Content="🚫 禁用全部" Style="{StaticResource SecondaryPillButton}" Click="DisableAllButton_Click" ToolTip="禁用所有MOD" Margin="0,0,10,0"/>
                <Button Content="✅ 启用全部" Style="{StaticResource SecondaryPillButton}" Click="EnableAllButton_Click" ToolTip="启用所有MOD" Margin="0,0,10,0"/>
                <Button Content="🗑️ 删除所选" Style="{StaticResource SecondaryPillButton}" Click="DeleteSelectedButton_Click" ToolTip="删除选中的MOD" Margin="0,0,10,0"/>
                <Button x:Name="LaunchGameBtn" Content="▶️ 启动游戏" Style="{StaticResource GradientCornerButton}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window> 