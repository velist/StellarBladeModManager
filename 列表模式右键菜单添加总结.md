# 列表模式右键菜单添加总结

## 问题描述

C1区列表模式下没有右键菜单功能，用户无法通过右键操作MOD，而卡片模式下有完整的右键菜单功能。

## 原因分析

经过代码检查发现：

1. 卡片视图(ModsCardView)的每个MOD卡片上已经添加了右键菜单(ContextMenu)
2. 列表视图(ModsListView)没有定义对应的右键菜单，只有直接点击按钮才能执行相关操作
3. 需要在列表视图中添加与卡片视图相同的右键菜单功能

## 解决方案

为列表视图(ModsListView)添加与卡片视图相同的右键菜单，确保用户在列表模式下也能通过右键点击执行所有操作。

## 具体修改

在MainWindow.xaml文件中为ModsListView添加ContextMenu定义：

```xml
<ListView.ContextMenu>
    <ContextMenu Style="{StaticResource DarkContextMenu}" Opened="ModContextMenu_Opened">
        <MenuItem Header="启用" Name="EnableModMenuItem" Style="{StaticResource DarkMenuItem}" Click="EnableModMenuItem_Click">
            <MenuItem.Icon>
                <TextBlock Text="✅" FontSize="12" Foreground="#10B981" />
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="禁用" Name="DisableModMenuItem" Style="{StaticResource DarkMenuItem}" Click="DisableModMenuItem_Click">
            <MenuItem.Icon>
                <TextBlock Text="⛔" FontSize="12" Foreground="#EF4444" />
            </MenuItem.Icon>
        </MenuItem>
        <Separator Style="{StaticResource DarkMenuSeparator}" />
        <MenuItem Header="编辑" Name="RenameModMenuItem" Style="{StaticResource DarkMenuItem}" Click="RenameModMenuItem_Click">
            <MenuItem.Icon>
                <TextBlock Text="✏️" FontSize="12" Foreground="#9CA3AF" />
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="更换预览图" Name="ChangePreviewMenuItem" Style="{StaticResource DarkMenuItem}" Click="ChangePreviewMenuItem_Click">
            <MenuItem.Icon>
                <TextBlock Text="🖼" FontSize="12" Foreground="#9CA3AF" />
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem Header="移动到分类" Name="MoveToCategoryMenuItem" Style="{StaticResource DarkMenuItem}">
            <MenuItem.Icon>
                <TextBlock Text="📂" FontSize="12" Foreground="#9CA3AF" />
            </MenuItem.Icon>
        </MenuItem>
        <Separator Style="{StaticResource DarkMenuSeparator}" />
        <MenuItem Header="删除" Name="DeleteModMenuItem" Style="{StaticResource DarkMenuItem}" Click="DeleteModMenuItem_Click">
            <MenuItem.Icon>
                <TextBlock Text="🗑" FontSize="12" Foreground="#EF4444" />
            </MenuItem.Icon>
        </MenuItem>
    </ContextMenu>
</ListView.ContextMenu>
```

由于右键菜单的事件处理方法已经在代码中实现，所以只需要添加ContextMenu定义即可，不需要额外修改C#代码。

## 测试验证

创建测试脚本`测试验证_列表模式右键菜单添加.ps1`，验证：

1. 切换到列表模式
2. 在列表模式下右键点击MOD，验证右键菜单是否显示
3. 测试右键菜单中各项功能是否正常工作，特别是"编辑"功能
4. 验证列表模式下的右键菜单功能是否与卡片模式一致

## 修复结果

现在列表模式下右键点击MOD也能显示完整的右键菜单，包括编辑、启用/禁用、更换预览图、移动到分类和删除等功能，与卡片模式的右键菜单功能完全一致。 